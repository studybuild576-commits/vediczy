name: Verify SHA-1 Key

on:
  workflow_dispatch:  # ğŸ–ï¸ Manual run from GitHub Actions UI

jobs:
  sha1-check:
    name: Print and Compare SHA-1 Fingerprint
    runs-on: ubuntu-latest

    env:
      CM_KEYSTORE: ${{ secrets.CM_KEYSTORE }}
      CM_KEYSTORE_PASSWORD: ${{ secrets.CM_KEYSTORE_PASSWORD }}
      CM_KEY_ALIAS: ${{ secrets.CM_KEY_ALIAS }}
      CM_KEY_PASSWORD: ${{ secrets.CM_KEY_PASSWORD }}
      ANDROID_SHA1_KEY: ${{ secrets.ANDROID_SHA1_KEY }}

    steps:
      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4

      - name: ğŸ” Setup Keystore File
        run: |
          echo "$CM_KEYSTORE" | base64 --decode > my-release-key.keystore

      - name: ğŸ” Print SHA-1 From Keystore
        run: |
          echo "== ğŸ” SHA-1 from actual .keystore =="
          keytool -list -v \
            -keystore my-release-key.keystore \
            -alias "$CM_KEY_ALIAS" \
            -storepass "$CM_KEYSTORE_PASSWORD" \
            -keypass "$CM_KEY_PASSWORD" | grep 'SHA1'

      - name: ğŸ“„ Print SHA-1 from Secret (Permanent Key)
        run: |
          echo "== ğŸ“„ Permanent SHA-1 from GitHub Secret =="
          echo "$ANDROID_SHA1_KEY"
