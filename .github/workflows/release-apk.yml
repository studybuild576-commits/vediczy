name: Show SHA1 Key from Permanent Keystore

on:
  workflow_dispatch:

jobs:
  show-sha1:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up JDK
        uses: actions/setup-java@v4
        with:
          java-version: '11'
          distribution: 'temurin'

      - name: Decode permanent keystore
        run: |
          echo "üì¶ Keystore decoding..."
          echo "${{ secrets.CM_KEYSTORE }}" | base64 --decode > android/app/upload-keystore.jks

      - name: Show SHA1 from permanent keystore
        run: |
          echo "üîê SHA1 Key (from keystore):"
          keytool -list -v \
            -keystore android/app/upload-keystore.jks \
            -alias "${{ secrets.CM_KEY_ALIAS }}" \
            -storepass "${{ secrets.CM_KEYSTORE_PASSWORD }}" \
            -keypass "${{ secrets.CM_KEY_PASSWORD }}" \
            | grep 'SHA1:'
