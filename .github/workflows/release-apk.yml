name: Print SHA-1 from Keystore

on:
  workflow_dispatch:  # üñêÔ∏è Manual trigger from GitHub UI

jobs:
  print-sha1:
    runs-on: ubuntu-latest

    env:
      CM_KEYSTORE: ${{ secrets.CM_KEYSTORE }}
      CM_KEYSTORE_PASSWORD: ${{ secrets.CM_KEYSTORE_PASSWORD }}
      CM_KEY_ALIAS: ${{ secrets.CM_KEY_ALIAS }}
      CM_KEY_PASSWORD: ${{ secrets.CM_KEY_PASSWORD }}
      ANDROID_SHA1_KEY: ${{ secrets.ANDROID_SHA1_KEY }}

    steps:
      - name: üì• Checkout repository
        uses: actions/checkout@v4

      - name: üõ†Ô∏è Set up keystore
        run: |
          echo "$CM_KEYSTORE" | base64 --decode > my-release-key.keystore

      - name: üîç Print SHA-1 from Keystore
        run: |
          echo "== Permanent SHA-1 (from env variable)=="
          echo "$ANDROID_SHA1_KEY"

          echo "== SHA-1 from actual .keystore file =="
          keytool -list -v \
            -keystore my-release-key.keystore \
            -alias "$CM_KEY_ALIAS" \
            -storepass "$CM_KEYSTORE_PASSWORD" \
            -keypass "$CM_KEY_PASSWORD" | grep SHA1
