name: Verify SHA-1 Key

on:
  workflow_dispatch:

jobs:
  sha1-check:
    runs-on: ubuntu-latest

    env:
      CM_KEYSTORE: ${{ secrets.CM_KEYSTORE }}
      CM_KEYSTORE_PASSWORD: ${{ secrets.CM_KEYSTORE_PASSWORD }}
      CM_KEY_ALIAS: ${{ secrets.CM_KEY_ALIAS }}
      CM_KEY_PASSWORD: ${{ secrets.CM_KEY_PASSWORD }}
      ANDROID_SHA1_KEY: ${{ secrets.ANDROID_SHA1_KEY }}

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Decode keystore
        run: echo "$CM_KEYSTORE" | base64 --decode > my-release-key.keystore

      - name: Print SHA-1 from Keystore
        run: |
          echo "🔐 SHA-1 from keystore:"
          keytool -list -v \
            -keystore my-release-key.keystore \
            -alias "$CM_KEY_ALIAS" \
            -storepass "$CM_KEYSTORE_PASSWORD" \
            -keypass "$CM_KEY_PASSWORD" | grep SHA1

      - name: Print Permanent SHA-1 from Secret
        run: |
          echo "📄 Permanent SHA-1 from secret:"
          echo "$ANDROID_SHA1_KEY"
